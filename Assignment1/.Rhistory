summary(adl3_1)$error
test <- summary(adl3_1)
summary(adl3_1)$sigma
fe1 <- summary(adl3_1)$sigma
pnorm(7.8, mean = UN_RATE[109], sd = fe1)
pnorm(7.8, mean = UN_RATE[109], sd = fe1)
1 - pnorm(7.8, mean = UN_RATE[109], sd = fe1)
"The probability that it is below 7.8:"
pnorm(7.8, mean = UN_RATE[109], sd = fe1)
"The probability that it is above 7.8:"
1 - pnorm(7.8, mean = UN_RATE[109], sd = fe1)
pnorm(0, mean=forecast1[1], sd = se1[1])
ar3$coef
ar3$coef[4]
h = 25
forecast_ar <-predict(gdp3, n.ahead=h)$pred
forecast_ar
forecast_ar <- as.numeric(forecast_ar)
GDP_QGR <- append(as.numeric(data2$GDP_QGR), numeric(h))
UN_RATE <- append(as.numeric(data2$UN_RATE), numeric(h))
n <- length(data2$obs)
GDP_QGR[n+1] = 2
for (i in 1:h){
j = i + n
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + n
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(1987, 2), frequency = 4)
UN <- ts_split(UN_RATE, sample.out = 8)
ts.plot(UN$train, xlim = c(1987, 2017))
points(UN$test, type="l", col=2)
ts.plot(UN$train, xlim = c(1987, 2021))
points(UN$test, type="l", col=2)
UN_RATE <- ts(UN_RATE, start = c(1987, 2), frequency = 4)
UN <- ts_split(UN_RATE, sample.out = h)
ts.plot(UN$train, xlim = c(1987, 2021))
points(UN$test, type="l", col=2)
ts.plot(UN$test)
h = 25
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + n
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(1987, 2), frequency = 4)
UN <- ts_split(UN_RATE, sample.out = h)
ts.plot(UN$train, xlim = c(1987, 2021))
points(UN$test, type="l", col=2)
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE, xlim = c(2013, 2021))
GDP_QGR <- ts(GDP_QGR, start = c(2013, 3), frequency = 4)
ts.plot(GDP_QGR, xlim = c(2013, 2021))
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
GDP_QGR <- ts(GDP_QGR, start = c(2013, 3), frequency = 4)
ts.plot(GDP_QGR, xlim = c(2013, 2021))
GDP_QGR <- ts(GDP_QGR, start = c(2013, 3), frequency = 4)
ts.plot(GDP_QGR)
ts.plot(UN_RATE)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
GDP_QGR <- ts(GDP_QGR, start = c(2013, 3), frequency = 4)
ts.plot(GDP_QGR)
ts.plot(UN_RATE)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
UN_RATE
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
UN_RATE
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(TSstudio)
library(stringr)
library(zoo)
library(ggplot2)
library(tseries)
library(stats)
library(lmtest)
library(Metrics)
library(dynlm)
library(dLagM)
# Load data
data <- read.csv("data_assign_p1.csv")
fmt <- "%YQ%q"
data$obs <- as.yearqtr(data$obs, format = fmt)
ggplot(data, aes(obs, GDP_QGR)) +
geom_point() +
geom_line() +
scale_x_yearqtr(format = fmt)
Acf(
data$GDP_QGR,
lag.max = 12
)
Pacf(
data$GDP_QGR,
lag.max = 12
)
ar4 <- arima(data$GDP_QGR, order = c(4,0,0))
coeftest(ar4)
ar3 <- arima(data$GDP_QGR, order = c(3,0,0))
coeftest(ar3)
ar2 <- arima(data$GDP_QGR, order = c(2,0,0))
coeftest(ar2)
ar1 <- arima(data$GDP_QGR, order = c(1,0,0))
coeftest(ar1)
checkresiduals(ar1)
seriesdata <- ts(data$GDP_QGR, start= c(1987, 2), end = c(2009, 1), frequency = 4)
forecast1 <- ts(predict(ar1, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
forecast1
ts.plot(forecast1, type="l")
ts.plot(seriesdata, xlim = c(1987, 2011))
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(seriesdata, xlim = c(2005, 2011))
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
pnorm(0, mean=forecast1[1], sd = se1[1])
ts.plot(seriesdata, xlim = c(1987, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(2005, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(1987,2011))
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(2005,2011))
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
rmse(re, forecast1)
rmse(re, forecast3)
error1 <-  re - forecast1
error3 <- re - forecast3
dm.test(error1, error3)
# Load data
data2 <- read.csv("data_assign_p2.csv")
fmt <- "%YQ%q"
data2$obs <- as.yearqtr(data2$obs, format = fmt)
ggplot(data2, aes(obs, GDP_QGR)) +
geom_point() +
geom_line() +
scale_x_yearqtr(format = fmt)
ggplot(data2, aes(obs, UN_RATE)) +
geom_point() +
geom_line() +
scale_x_yearqtr(format = fmt)
data3 = data2
data3$GDP_QGR <- ts(data3$GDP_QGR, start = c(1987,2), frequency = 4)
data3$UN_RATE <- ts(data3$UN_RATE, start = c(1987,2), frequency = 4)
gdp4 <- arima(data3$GDP_QGR, order = c(4,0,0))
coeftest(gdp4)
gdp3 <- arima(data3$GDP_QGR, order = c(3,0,0))
coeftest(gdp3)
adl4_4 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:4) + L(data3$GDP_QGR, 0:4))
coeftest(adl4_4)
adl3_3 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 0:3))
coeftest(adl3_3)
adl3_2 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 0:2))
coeftest(adl3_2)
adl3_1 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 0:1))
coeftest(adl3_1)
adl3_0 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 0:0))
coeftest(adl3_0)
adl3_1 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, c(1,3)) + L(data3$GDP_QGR, 1:1))
coeftest(adl3_1)
h = 8
forecast_ar <-predict(gdp3, n.ahead=h)$pred
forecast_ar
forecast_ar <- as.numeric(forecast_ar)
GDP_QGR <- append(as.numeric(data2$GDP_QGR), forecast_ar)
UN_RATE <- append(as.numeric(data2$UN_RATE), numeric(h))
n <- length(data2$obs)
for (i in 1:h){
j = i + n
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
fe1 <- summary(adl3_1)$sigma
"The probability that it is below 7.8:"
pnorm(7.8, mean = UN_RATE[109], sd = fe1)
"The probability that it is above 7.8:"
1 - pnorm(7.8, mean = UN_RATE[109], sd = fe1)
UN$test
UN_RATE <- ts(UN_RATE, start = c(1987, 2), frequency = 4)
UN <- ts_split(UN_RATE, sample.out = h)
ts.plot(UN$train, xlim = c(1987, 2017))
points(UN$test, type="l", col=2)
ts.plot(UN$train, xlim = c(2000, 2017))
points(UN$test, type="l", col=2)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
ts.plot(UN_RATE)
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
re
library(tsoutliers)
install.packages("tsoutliers")
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(TSstudio)
library(stringr)
library(zoo)
library(ggplot2)
library(tseries)
library(stats)
library(lmtest)
library(Metrics)
library(dynlm)
library(dLagM)
library(tsoutliers)
jarque.bera.test(ar1)
View(ar1)
jarque.bera.test(ar1$resiudals)
ar1$residuals
jarque.bera.test(ar1$residuals)
jarque.bera.test(adl3_1$residuals)
pnorm(0, mean=forecast1[1], sd = se1[1])
jarque.bera.test(ar1$residuals)
ts.plot(seriesdata, xlim = c(1987, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(2005, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ar3
ts.plot(seriesdata, xlim = c(2005,2011))
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
ts.plot(UN_RATE)
error1 <-  re - forecast1
error3 <- re - forecast3
dm.test(error1, error3)
gdp4 <- arima(data3$GDP_QGR, order = c(4,0,0))
coeftest(gdp4)
gdp3 <- arima(data3$GDP_QGR, order = c(3,0,0))
coeftest(gdp3)
adl4_4 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:4) + L(data3$GDP_QGR, 0:4))
coeftest(adl4_4)
adl3_3 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 0:3))
coeftest(adl3_3)
adl3_0 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 0:0))
coeftest(adl3_0)
adl3_1 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, c(1,3)) + L(data3$GDP_QGR, 1:1))
coeftest(adl3_1)
adl2_0 <- dynlm(data3$UN_RATE ~ L(data3$UN_RATE, 1:3) + L(data3$GDP_QGR, 1:1))
coeftest(adl2_0)
ts.plot(UN_RATE)
adl3_1$coefficients[1]
adl3_1$coefficients[2]
adl3_1$coefficients[2]*adl3_1$coefficients[4]
as.numeric(adl3_1$coefficients[2]*adl3_1$coefficients[4])
as.numeric(adl3_1$coefficients[1]/(1-adl3_1$coefficients[2]-adl3_1$coefficients[3]))
as.numeric(adl3_1$coefficients[4]/(1-adl3_1$coefficients[2]-adl3_1$coefficients[3]))
ts.plot(UN_RATE)
adl3_1$coefficients[1]
adl3_1$coefficient[1]
UN_RATE[78]
ar3$coef[4]
GDP_QGR <- ts(GDP_QGR, start = c(2013, 3), frequency = 4)
ts.plot(GDP_QGR)
h = 200
GDP_QGR <- append(rep(0,3), numeric(h))
UN_RATE <- append(rep(0,3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
GDP_QGR <- ts(GDP_QGR, start = c(2013, 3), frequency = 4)
ts.plot(GDP_QGR)
as.numeric(adl3_1$coefficients[1]/(1-adl3_1$coefficients[2]-adl3_1$coefficients[3]))
as.numeric(adl3_1$coefficients[4]/(1-adl3_1$coefficients[2]-adl3_1$coefficients[3]))
as.numeric(gdp3$coef[1])
as.numeric(gdp3$coef[4]/(1-gdp3$coef[1]-gdp3$coef[2]-gdp3$coef[3]))
as.numeric(adl3_1$coefficients[1]/(1-adl3_1$coefficients[2]-adl3_1$coefficients[3])) + as.numeric(adl3_1$coefficients[4]/(1-adl3_1$coefficients[2]-adl3_1$coefficients[3])) * as.numeric(gdp3$coef[4]/(1-gdp3$coef[1]-gdp3$coef[2]-gdp3$coef[3]))
ts.plot(UN_RATE)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = 2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
h = 200
GDP_QGR <- append(rep(data2$GDP_QGR[n],3), numeric(h))
UN_RATE <- append(rep(data2$UN_RATE[n],3), numeric(h))
GDP_QGR[3+1] = -2
for (i in 1:h){
j = i + 3
GDP_QGR[j] <- GDP_QGR[j] + ar3$coef[4] + ar3$coef[1] * GDP_QGR[j-1] + ar3$coef[2] * GDP_QGR[j-2] + ar3$coef[3] * GDP_QGR[j-3]
}
n <- length(data2$obs)
for (i in 1:h){
j = i + 3
UN_RATE[j] <- adl3_1$coefficient[1] + adl3_1$coefficient[2] * UN_RATE[j-1] + adl3_1$coefficient[3] * UN_RATE[j-3] + adl3_1$coefficient[4] * GDP_QGR[j-1]
}
UN_RATE <- ts(UN_RATE, start = c(2013, 3), frequency = 4)
ts.plot(UN_RATE)
