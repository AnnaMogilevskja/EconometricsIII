install.Rtools()
install.Rtools
install.packages("installr")
install.Rtools()
install.packages("stat")
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
write('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', file = "~/.Renviron", append = TRUE)
Sys.which("make")
install.packages("jsonlite", type = "source")
install.packages("stats")
install.packages("stats")
install.packages("stats")
devtools::install_github("arunsrinivasan/cran.stats")
p_load(stats)
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(TSstudio)
library(stringr)
library(zoo)
library(ggplot2)
library(tseries)
library(stats)
library(lmtest)
library(Metrics)
# Load data
data <- read.csv("data_assign_p1.csv")
fmt <- "%YQ%q"
data$obs <- as.yearqtr(data$obs, format = fmt)
ggplot(data, aes(obs, GDP_QGR)) +
geom_point() +
geom_line() +
scale_x_yearqtr(format = fmt)
Acf(
data$GDP_QGR,
lag.max = 12
)
Pacf(
data$GDP_QGR,
lag.max = 12
)
ar4 <- arima(data$GDP_QGR, order = c(4,0,0))
coeftest(ar4)
ar3 <- arima(data$GDP_QGR, order = c(3,0,0))
coeftest(ar3)
ar2 <- arima(data$GDP_QGR, order = c(2,0,0))
coeftest(ar2)
ar1 <- arima(data$GDP_QGR, order = c(1,0,0))
coeftest(ar1)
checkresiduals(ar1)
plot(predict(ar1, n.ahead=8)$pred, type="l")
ts.plot(data$GDP_QGR[-(1:40)])
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
points(forecast1, type="l", col=2)
ts.plot(data$GDP_QGR)
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
t_stat = (forecast1[1]-0)/se1[1]
n = length(data$obs)
pt(t_stat, n-2, lower.tail = FALSE)
ts.plot(data$GDP_QGR)
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start=89, end=96)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(data$GDP_QGR)
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
forecast3 <- predict(ar3, n.ahead=8)$pred
se3 <- predict(ar3, n.ahead=8)$se
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start=89, end=96)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
rmse(re, forecast1)
rmse(re, forecast3)
error1 <-  re - forecast1
error3 <- re - forecast3
dm.test(error1, error3)
View(data)
plot(data$obs, predict(ar1, n.ahead=8)$pred, type="l")
plot(predict(ar1, n.ahead=8)$pred, type="l")
predict(ar1, n.ahead=8)
data$GDP_QGR <- predict(ar1, n.ahead=8)$pred
View(data)
data$GDP_QGR <- predict(ar1, n.ahead=8)$pred
predict(ar1, n.ahead=8)$pred
data <- rbind(data, predict(ar1, n.ahead=8)$pred)
View(data)
try <- predict(ar1, n.ahead=8)$pred
# Load data
data <- read.csv("data_assign_p1.csv")
fmt <- "%YQ%q"
data$obs <- as.yearqtr(data$obs, format = fmt)
try <- ts(data$GDP_QGR, start= c(1987, 2), end = c(2009, 1), frequency = 4)
try
a <- predict(ar1, n.ahead=8)$pred
a <- predict(ar1, n.ahead=8)$pred
new <- ts(c(try, a),
start = start(try),
frequency = frequency(try))
new
plot(new[89:96], type="l")
ts.plot(new[89:96], type="l")
ts_plot(new[89:96], type="l")
ts.plot(new[89:96], type="l")
ts.plot(new, type="l")
new[89]
a <- predict(ar1, n.ahead=8)$pred
new <- ts(c(try, a),
start = start(try),
frequency = frequency(try))
b <- ts_split(new, sample.out = 8)
b
ts.plot((b, type="l")
ts.plot(b, type="l")
a <- predict(ar1, n.ahead=8)$pred
new <- ts(c(try, a),
start = start(try),
frequency = frequency(try))
b <- ts_split(new, sample.out = 8)$test
ts.plot(b, type="l")
b
ts.plot(data$GDP_QGR[-(1:40)])
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
points(forecast1, type="l", col=2)
a <- predict(ar1, n.ahead=8)$pred
new <- ts(c(try, a),
start = start(try),
frequency = frequency(try))
b <- ts_split(new, sample.out = 8)
ts.plot(b$test, type="l")
ts.plot(b$train)
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
points(b$test, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(b$train[44:88])
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
points(b$test, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(b$train)
forecast1 <- predict(ar1, n.ahead=8)$pred
se1 <- predict(ar1, n.ahead=8)$se
points(b$test, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
forecast1
ts.plot(b$train)
se1 <- predict(ar1, n.ahead=8, start = c(2009, 2), frequency = 4)$se
points(b$test, type="l", col=2)
points(b$test - 1.96*se1, type="l", col=2, lty=2)
se1
b
ts.plot(b$train)
se1 <- predict(ar1, n.ahead=8, start = c(2009, 2), end = c(2011, 1), frequency = 4)$se
points(b$test, type="l", col=2)
points(b$test - 1.96*se1, type="l", col=2, lty=2)
se1
View(ar1)
se1 <- ts(se1, start = c(2009,2), frequency = 4)
se1
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
se1
ts.plot(b$train)
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(b$test, type="l", col=2)
points(b$test - 1.96*se1, type="l", col=2, lty=2)
points(b$test + 1.96*se1, type="l", col=2, lty=2)
a <- ts(predict(ar1, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
#new <- ts(c(try, a),
#         start = start(try),
#        frequency = frequency(try))
#b <- ts_split(new, sample.out = 8)
ts.plot(a, type="l")
ts.plot(try)
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(a, type="l", col=2)
points(a - 1.96*se1, type="l", col=2, lty=2)
points(a + 1.96*se1, type="l", col=2, lty=2)
t_stat = (a[1]-0)/se1[1]
n = length(data$obs)
pt(t_stat, n-2, lower.tail = FALSE)
ts.plot(try)
#forecast1 <- predict(ar1, n.ahead=8)$pred
#se1 <- predict(ar1, n.ahead=8)$se
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(a, type="l", col=2)
points(a - 1.96*se1, type="l", col=2, lty=2)
points(a + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(try)
#forecast1 <- predict(ar1, n.ahead=8)$pred
#se1 <- predict(ar1, n.ahead=8)$se
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
#re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start=89, end=96)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
ts.plot(try)
#forecast1 <- predict(ar1, n.ahead=8)$pred
#se1 <- predict(ar1, n.ahead=8)$se
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
#re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start=89, end=96)
points(a, type="l", col=2)
points(a - 1.96*se1, type="l", col=2, lty=2)
points(a + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
rmse(re, a)
rmse(re, forecast3)
error1 <-  re - a
error3 <- re - forecast3
dm.test(error1, error3)
ts.plot(seriesdata[44:89])
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(TSstudio)
library(stringr)
library(zoo)
library(ggplot2)
library(tseries)
library(stats)
library(lmtest)
library(Metrics)
# Load data
data <- read.csv("data_assign_p1.csv")
fmt <- "%YQ%q"
data$obs <- as.yearqtr(data$obs, format = fmt)
ggplot(data, aes(obs, GDP_QGR)) +
geom_point() +
geom_line() +
scale_x_yearqtr(format = fmt)
Acf(
data$GDP_QGR,
lag.max = 12
)
Pacf(
data$GDP_QGR,
lag.max = 12
)
ar4 <- arima(data$GDP_QGR, order = c(4,0,0))
coeftest(ar4)
ar3 <- arima(data$GDP_QGR, order = c(3,0,0))
coeftest(ar3)
ar2 <- arima(data$GDP_QGR, order = c(2,0,0))
coeftest(ar2)
ar1 <- arima(data$GDP_QGR, order = c(1,0,0))
coeftest(ar1)
checkresiduals(ar1)
seriesdata <- ts(data$GDP_QGR, start= c(1987, 2), end = c(2009, 1), frequency = 4)
forecast1 <- ts(predict(ar1, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
ts.plot(forecast1, type="l")
ts.plot(seriesdata)
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
t_stat = (forecast1[1]-0)/se1[1]
n = length(data$obs)
pt(t_stat, n-2, lower.tail = FALSE)
ts.plot(seriesdata)
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata)
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
rmse(re, forecast1)
rmse(re, forecast3)
error1 <-  re - forecast1
error3 <- re - forecast3
dm.test(error1, error3)
ts.plot(seriesdata[44:88])
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(seriesdata, start = c(2000,1))
ts.plot(seriesdata, start = c(2000,1), frequency = 4)
ts.plot(seriesdata)
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
seriesdata_short <- ts_split(seriesdata, sample.out = 40)
seriesdata_short <- ts_split(seriesdata, sample.out = 40)$test
ts.plot(seriesdata_short)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(seriesdata_short)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
seriesdata_short <- ts_split(seriesdata, sample.out = 20)$test
ts.plot(seriesdata_short)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
seriesdata_short
ts.plot(seriesdata_short)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata_short, ylim = c(-2, 4))
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata_short, ylim = c(-4, 4))
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata_short, ylim = c(-4, 4), xlim = c(2005, 2011))
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(2005, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata)
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(1990, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(1987, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(2005, 2011))
re <- ts(c(-1.63,0.28, 0.33, 0.66, 1.59, 0.51, 0.71, 0.81), start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(2005, 2011))
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(seriesdata, xlim = c(1987, 2011))
se1 <- ts(predict(ar1, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
ts.plot(seriesdata, xlim = c(2005,2011))
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
ts.plot(seriesdata, xlim = c(1987,2011))
forecast3 <- ts(predict(ar3, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
se3 <- ts(predict(ar3, n.ahead=8)$se, start = c(2009,2), frequency = 4)
points(forecast1, type="l", col=2)
points(forecast1 - 1.96*se1, type="l", col=2, lty=2)
points(forecast1 + 1.96*se1, type="l", col=2, lty=2)
points(forecast3, type="l", col=4)
points(forecast3 - 1.96*se3, type="l", col=4, lty=2)
points(forecast3 + 1.96*se3, type="l", col=4, lty=2)
points(re, type="l", col=3)
rmse(re, forecast1)
rmse(re, forecast3)
error1 <-  re - forecast1
error3 <- re - forecast3
dm.test(error1, error3)
View(data)
View(data)
seriesdata <- ts(data$GDP_QGR, start= c(1987, 2), end = c(2009, 1), frequency = 4)
forecast1 <- ts(predict(ar1, n.ahead=8)$pred, start = c(2009,2), frequency = 4)
forecast1
seriesdata
