---
title: "Econometrics III - Assignment 2"
author: "The Explosive Invertibles"
date: "01 Apr 2022"
output:
  pdf_document:
    includes:
      in_header: "preamble.tex"
---
```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
library(TSstudio)
library(stringr)
library(zoo)
library(ggplot2)
library(tseries)
library(stats)
library(lmtest)
library(Metrics)
library(dynlm)
library(dLagM)
library(tsoutliers)
```

# Question 1

```{r}
# Load data
data <- read.csv("data_assign_p3.csv")
```




```{r}
set.seed(20)
t = 100
n = 10000

sigma_u = 1
sigma_v = 1

# Create the first value
x <- data.frame(rnorm(n,0,sigma_v))
y <- data.frame(rnorm(n,0,sigma_u))

# Generate Random walk
for (i in 1:(t-1)){
v <- as.numeric(x[i,]) + rnorm(n,0,sigma_v)
x <- data.frame(x, v)

u <- as.numeric(y[i,]) + rnorm(n,0,sigma_u)
y <- data.frame(y, v)
}

# Run regressions & store beta, SE and R^2
est <- matrix(,nrow = n, ncol =3)

for (i in 1:n){
  reg <- summary(lm(as.numeric(y[i,])~ as.numeric(x[i,])))
  est[i,1] <- reg$coef[2,1]
  est[i,2] <- reg$coef[2,2]
  est[i,3] <- reg$r.squared
}

```

```{r}
# Plot histograms
plot(density(est[,1])$x,density(est[,1])$y,type="l",xlab="Distribution of estimated betas",ylab="Density")
plot(density(est[,2])$x,density(est[,2])$y,type="l",xlab="Distribution of estimated S.E.",ylab="Density")
plot(density(est[,3])$x,density(est[,3])$y,type="l",xlab="Distribution of R^2",ylab="Density")
```


2. Provide plots for two stock market time-series at your choice and report 12-period ACF
and PACF functions for those two time series. What does the sample ACF tell you about
the dynamic properties of these stocks?
```{r}
data$DATE<- as.Date(data$DATE, format = "%d/%m/%Y")
```

```{r}
ggplot(data, aes(x = DATE, y = NETFLIX)) + 
  geom_line() 
```
```{r}
ggplot(data, aes(x = DATE, y = APPLE)) + 
  geom_line() 
```

```{r}
Acf(
  data$NETFLIX,
  lag.max = 12
)
```

```{r}
Pacf(
  data$NETFLIX,
  lag.max = 12
)
```
```{r}
Acf(
  data$APPLE,
  lag.max = 12
)
```

```{r}
Pacf(
  data$APPLE,
  lag.max = 12
)
```

DON'T FORGET TO TALK ABOUT CONFIDENCE INTERVALS!

3. Perform an ADF unit-root test for all the 10 time series using the general-to-specific
approach based on the Schwarz Information Criterion (SIC). Report the values of the
ADF test statistics. Is the unit-root hypothesis rejected for any time-series at the 90%
confidence level? Did you expect to reject the unit-root hypothesis for some time-series at
this confidence level? Justify your answer carefully.

```{r}
netflix <- auto.arima(data$NETFLIX, d = 0, D = 0, max.p = 5, max.q = 5, ic = "aic")
```


# Question 2
```{r}
set.seed(20)
t = 100
n = 10000

sigma_u = 1
sigma_v = 1

gamma = 1.5

# Create the first value
x <- data.frame(rnorm(n,0,sigma_v))
y <- data.frame(rnorm(n,0,sigma_u))

# Generate Random walk
for (i in 1:(t-1)){
v <- as.numeric(x[i,]) + rnorm(n,0,sigma_v)
x <- data.frame(x, v)

u <- as.numeric(x[(i+1),]) + gamma * rnorm(n,0,sigma_u)
y <- data.frame(y, v)
}

# Run regressions & store beta, SE and R^2
est <- matrix(,nrow = n, ncol =3)

for (i in 1:n){
  reg <- summary(lm(as.numeric(y[i,])~ as.numeric(x[i,])))
  est[i,1] <- reg$coef[2,1]
  est[i,2] <- reg$coef[2,2]
  est[i,3] <- reg$r.squared
}

```

```{r}
# Plot histograms
plot(density(est[,1])$x,density(est[,1])$y,type="l",xlab="Distribution of estimated betas",ylab="Density")
plot(density(est[,2])$x,density(est[,2])$y,type="l",xlab="Distribution of estimated S.E.",ylab="Density")
plot(density(est[,3])$x,density(est[,3])$y,type="l",xlab="Distribution of R^2",ylab="Density")
```
